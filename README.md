# Классификация писем с Naive Bayes

## Описание проекта

Этот проект представляет собой систему классификации писем с использованием метода наивного Байеса. Цель - обучить модель распознавать категории писем на основе их заголовков и текста.

## Структура проекта

* **Загрузка и обработка данных** : Чтение писем из JSON-файла, извлечение заголовков, тел писем и меток.
* **Предобработка текста** : Очистка HTML, удаление невидимых символов, токенизация, удаление стоп-слов, стемминг и лемматизация.
* **Обучение модели** : Использование алгоритма Multinomial Naive Bayes для классификации писем.
* **Оценка качества модели** : Кросс-валидация и тестирование на отдельном наборе данных.

## Установка и запуск

### Требования

Перед запуском убедитесь, что у вас установлены необходимые библиотеки:

```sh
pip install numpy nltk scikit-learn tqdm beautifulsoup4
```

### Запуск проекта

1. **Подготовьте JSON-файл** с письмами в формате Gmail Takeout.
2. **Запустите скрипт** для обработки и классификации писем.

```sh
python main.py
```

## Описание кода

* **Обработка данных** : Используется `BeautifulSoup` для очистки HTML и `email.header` для декодирования заголовков.
* **Предобработка текста** : Применяется `nltk` для токенизации, удаления стоп-слов, стемминга и лемматизации.
* **Обучение модели** : Реализован собственный класс `MultinomialNaiveBayes` с лапласовым сглаживанием.
* **Кросс-валидация** : Используется `KFold` из `sklearn` для оценки модели на разных поднаборах данных.

## Оценка модели

Модель оценивается с использованием метрик `accuracy_score` и `classification_report`, отображая точность классификации.

### Результаты на тестовой выборке:

| Категория                  | Precision | Recall | F1-score       | Support |
| ----------------------------------- | --------- | ------ | -------------- | ------- |
| Архив                          | 0.27      | 0.15   | 0.19           | 53      |
| Входящие                    | 0.98      | 0.99   | 0.98           | 2651    |
| Категория "Покупки" | 1.00      | 0.40   | 0.57           | 5       |
| Отправленные            | 0.17      | 0.25   | 0.20           | 8       |
| Прочитанные              | 0.00      | 0.00   | 0.00           | 1       |
| Спам                            | 1.00      | 0.14   | 0.25           | 7       |
| Черновики                  | 0.00      | 0.00   | 0.00           | 5       |
| **Accuracy**                  |           |        | **0.96** | 2730    |
| **Macro avg**                 | 0.49      | 0.28   | 0.31           | 2730    |
| **Weighted avg**              | 0.96      | 0.96   | 0.96           | 2730    |

Модель показала **96% точности**

## Дальнейшее использование

С помощью pickle можно загрузить объект обученной модели
